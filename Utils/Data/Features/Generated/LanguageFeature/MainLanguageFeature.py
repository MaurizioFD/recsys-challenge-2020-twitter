import numpy as np
from tqdm import tqdm

import Utils.Data as data
from Utils.Data.DatasetUtils import is_test_or_val_set, get_train_set_id_from_test_or_val_set, \
    get_test_or_val_set_id_from_train
from Utils.Data.Dictionary.UserBasicFeaturesDictArray import UserBasicFeatureDictArrayNumpy
from Utils.Data.Dictionary.UserFeaturesDictArray import MainLanguageUserBasicFeatureDictArray
from Utils.Data.Features.Generated.TweetFeature.IsEngagementType import *
from Utils.Data.Features.MappedFeatures import MappedFeatureEngagerId, MappedFeatureCreatorId, \
    MappedFeatureTweetLanguage, MappedFeatureTweetId
from Utils.Data.Sparse.CSR_SparseMatrix import CSR_SparseMatrix
import scipy.sparse as sps
import time
import multiprocessing as mp

def find_and_increase_engager(engager, creator, language, engagement, counter_array):
    if counter_array[engager].sum() < 1:
        current_count = -1
    else:
        current_count = np.argmax(counter_array[engager])
    if engagement:
        counter_array[engager][language] = counter_array[engager][language] + 1
    counter_array[creator][language] = counter_array[creator][language] + 1
    return current_count

def find_and_increase_creator(engager, creator, language, engagement, counter_array):
    if counter_array[creator].sum() < 1:
        current_count = -1
    else:
        current_count = np.argmax(counter_array[creator])
    if engagement:
        counter_array[engager][language] = counter_array[engager][language] + 1
    counter_array[creator][language] = counter_array[creator][language] + 1
    return current_count

class EngagerMainLanguage(GeneratedFeaturePickle):

    def __init__(self, dataset_id: str):
        super().__init__("engager_main_language", dataset_id)
        self.pck_path = pl.Path(
            f"{Feature.ROOT_PATH}/{self.dataset_id}/generated/main_language/{self.feature_name}.pck.gz")
        self.csv_path = pl.Path(
            f"{Feature.ROOT_PATH}/{self.dataset_id}/generated/main_language/{self.feature_name}.csv.gz")

    def create_feature(self):

        # Check if the dataset id is train or test
        if is_test_or_val_set(self.dataset_id):
            train_dataset_id = get_train_set_id_from_test_or_val_set(self.dataset_id)
            test_dataset_id = self.dataset_id
        else:
            train_dataset_id = self.dataset_id
            test_dataset_id = get_test_or_val_set_id_from_train(train_dataset_id)

        # Load features
        creation_timestamps_feature = RawFeatureTweetTimestamp(train_dataset_id)
        creators_feature = MappedFeatureCreatorId(train_dataset_id)
        engagers_feature = MappedFeatureEngagerId(train_dataset_id)
        language_feature = MappedFeatureTweetLanguage(train_dataset_id)
        engagement_feature = TweetFeatureEngagementIsPositive(train_dataset_id)

        dataframe = pd.concat([
            creation_timestamps_feature.load_or_create(),
            creators_feature.load_or_create(),
            engagers_feature.load_or_create(),
            language_feature.load_or_create(),
            engagement_feature.load_or_create()
        ], axis=1)

        dataframe.sort_values(creation_timestamps_feature.feature_name, inplace=True)

        engager_counter_array = np.zeros((data.DataStats.get_max_user_id() + 1, 71), dtype=np.uint16)
        result = pd.DataFrame(
            [find_and_increase_engager(engager_id, creator_id, language, engagement, engager_counter_array)
             for engager_id, creator_id, language, engagement
             in tqdm(zip(dataframe[engagers_feature.feature_name],
                    dataframe[creators_feature.feature_name],
                    dataframe[language_feature.feature_name],
                    dataframe[engagement_feature.feature_name]
                    ))],
            index=dataframe.index
        )
        if not EngagerMainLanguage(train_dataset_id).has_feature():
            result.sort_index(inplace=True)
            EngagerMainLanguage(train_dataset_id).save_feature(result)
        if not EngagerMainLanguage(test_dataset_id).has_feature():
            # Load features
            creation_timestamps_feature = RawFeatureTweetTimestamp(test_dataset_id)
            creators_feature = MappedFeatureCreatorId(test_dataset_id)
            engagers_feature = MappedFeatureEngagerId(test_dataset_id)
            language_feature = MappedFeatureTweetLanguage(test_dataset_id)

            dataframe = pd.concat([
                creation_timestamps_feature.load_or_create(),
                creators_feature.load_or_create(),
                engagers_feature.load_or_create(),
                language_feature.load_or_create()
            ], axis=1)

            dataframe.sort_values(creation_timestamps_feature.feature_name, inplace=True)

            result = pd.DataFrame(
                [find_and_increase_engager(engager_id, creator_id, language, False, engager_counter_array)
                 for engager_id, creator_id, language
                 in zip(dataframe[engagers_feature.feature_name],
                        dataframe[creators_feature.feature_name],
                        dataframe[language_feature.feature_name]
                        )],
                index=dataframe.index
            )

            result.sort_index(inplace=True)

            EngagerMainLanguage(test_dataset_id).save_feature(result)


class CreatorMainLanguage(GeneratedFeaturePickle):

    def __init__(self, dataset_id: str):
        super().__init__("creator_main_language", dataset_id)
        self.pck_path = pl.Path(
            f"{Feature.ROOT_PATH}/{self.dataset_id}/generated/main_language/{self.feature_name}.pck.gz")
        self.csv_path = pl.Path(
            f"{Feature.ROOT_PATH}/{self.dataset_id}/generated/main_language/{self.feature_name}.csv.gz")

    def create_feature(self):

        # Check if the dataset id is train or test
        if is_test_or_val_set(self.dataset_id):
            train_dataset_id = get_train_set_id_from_test_or_val_set(self.dataset_id)
            test_dataset_id = self.dataset_id
        else:
            train_dataset_id = self.dataset_id
            test_dataset_id = get_test_or_val_set_id_from_train(train_dataset_id)

        # Load features
        creation_timestamps_feature = RawFeatureTweetTimestamp(train_dataset_id)
        creators_feature = MappedFeatureCreatorId(train_dataset_id)
        engagers_feature = MappedFeatureEngagerId(train_dataset_id)
        language_feature = MappedFeatureTweetLanguage(train_dataset_id)
        engagement_feature = TweetFeatureEngagementIsPositive(train_dataset_id)

        dataframe = pd.concat([
            creation_timestamps_feature.load_or_create(),
            creators_feature.load_or_create(),
            engagers_feature.load_or_create(),
            language_feature.load_or_create(),
            engagement_feature.load_or_create()
        ], axis=1)

        dataframe.sort_values(creation_timestamps_feature.feature_name, inplace=True)

        engager_counter_array = np.zeros(
            (data.DataStats.get_max_user_id() + 1, 71), dtype=int)

        result = pd.DataFrame(
            [find_and_increase_creator(engager_id, creator_id, language, engagement, engager_counter_array)
             for engager_id, creator_id, language, engagement
             in zip(dataframe[engagers_feature.feature_name],
                    dataframe[creators_feature.feature_name],
                    dataframe[language_feature.feature_name],
                    dataframe[engagement_feature.feature_name]
                    )],
            index=dataframe.index
        )
        if not CreatorMainLanguage(train_dataset_id).has_feature():
            result.sort_index(inplace=True)
            CreatorMainLanguage(train_dataset_id).save_feature(result)
        if not CreatorMainLanguage(test_dataset_id).has_feature():
            # Load features
            creation_timestamps_feature = RawFeatureTweetTimestamp(test_dataset_id)
            creators_feature = MappedFeatureCreatorId(test_dataset_id)
            engagers_feature = MappedFeatureEngagerId(test_dataset_id)
            language_feature = MappedFeatureTweetLanguage(test_dataset_id)

            dataframe = pd.concat([
                creation_timestamps_feature.load_or_create(),
                creators_feature.load_or_create(),
                engagers_feature.load_or_create(),
                language_feature.load_or_create()
            ], axis=1)

            dataframe.sort_values(creation_timestamps_feature.feature_name, inplace=True)

            result = pd.DataFrame(
                [find_and_increase_creator(engager_id, creator_id, language, False, engager_counter_array)
                 for engager_id, creator_id, language
                 in zip(dataframe[engagers_feature.feature_name],
                        dataframe[creators_feature.feature_name],
                        dataframe[language_feature.feature_name]
                        )],
                index=dataframe.index
            )

            result.sort_index(inplace=True)

            CreatorMainLanguage(test_dataset_id).save_feature(result)


class CreatorAndEngagerHaveSameMainLanguage(GeneratedFeaturePickle):

    def __init__(self, dataset_id: str):
        super().__init__("creator_and_engager_have_same_main_language", dataset_id)
        self.pck_path = pl.Path(
            f"{Feature.ROOT_PATH}/{self.dataset_id}/generated/main_language/{self.feature_name}.pck.gz")
        self.csv_path = pl.Path(
            f"{Feature.ROOT_PATH}/{self.dataset_id}/generated/main_language/{self.feature_name}.csv.gz")

    def create_feature(self):
        creator_main_language_feature = CreatorMainLanguage(self.dataset_id)
        engager_main_language_feature = EngagerMainLanguage(self.dataset_id)

        creator_main_language_df = creator_main_language_feature.load_or_create()
        engager_main_language_df = engager_main_language_feature.load_or_create()

        result = pd.DataFrame(
            [x == y if x is not -1 else False
             for x, y
             in zip(creator_main_language_df[creator_main_language_feature.feature_name],
                    engager_main_language_df[engager_main_language_feature.feature_name])
             ]
        )

        self.save_feature(result)


class IsTweetInCreatorMainLanguage(GeneratedFeaturePickle):

    def __init__(self, dataset_id: str):
        super().__init__("is_tweet_in_creator_main_language", dataset_id)
        self.pck_path = pl.Path(
            f"{Feature.ROOT_PATH}/{self.dataset_id}/generated/main_language/{self.feature_name}.pck.gz")
        self.csv_path = pl.Path(
            f"{Feature.ROOT_PATH}/{self.dataset_id}/generated/main_language/{self.feature_name}.csv.gz")

    def create_feature(self):
        creator_main_language_feature = CreatorMainLanguage(self.dataset_id)
        tweet_language_feature = MappedFeatureTweetLanguage(self.dataset_id)

        creator_main_language_df = creator_main_language_feature.load_or_create()
        tweet_language_df = tweet_language_feature.load_or_create()

        result = pd.DataFrame(
            [x == y
             for x, y
             in zip(creator_main_language_df[creator_main_language_feature.feature_name],
                    tweet_language_df[tweet_language_feature.feature_name])]
        )

        self.save_feature(result)


class IsTweetInEngagerMainLanguage(GeneratedFeaturePickle):

    def __init__(self, dataset_id: str):
        super().__init__("is_tweet_in_engager_main_language", dataset_id)
        self.pck_path = pl.Path(
            f"{Feature.ROOT_PATH}/{self.dataset_id}/generated/main_language/{self.feature_name}.pck.gz")
        self.csv_path = pl.Path(
            f"{Feature.ROOT_PATH}/{self.dataset_id}/generated/main_language/{self.feature_name}.csv.gz")

    def create_feature(self):
        engager_main_language_feature = EngagerMainLanguage(self.dataset_id)
        tweet_language_feature = MappedFeatureTweetLanguage(self.dataset_id)

        engager_main_language_df = engager_main_language_feature.load_or_create()
        tweet_language_df = tweet_language_feature.load_or_create()

        result = pd.DataFrame(
            [x == y
             for x, y
             in zip(engager_main_language_df[engager_main_language_feature.feature_name],
                    tweet_language_df[tweet_language_feature.feature_name])]
        )

        self.save_feature(result)


class StatisticalProbabilityMainLanguageOfEngagerEngageTweetLanguage1(GeneratedFeaturePickle):

    def __init__(self, dataset_id: str):
        super().__init__("statistical_probability_main_language_of_engager_engage_tweet_language_1", dataset_id)
        self.pck_path = pl.Path(
            f"{Feature.ROOT_PATH}/{self.dataset_id}/generated/main_language/{self.feature_name}.pck.gz")
        self.csv_path = pl.Path(
            f"{Feature.ROOT_PATH}/{self.dataset_id}/generated/main_language/{self.feature_name}.csv.gz")
        self.statistical_data = np.array(66)
        self.statistical_data = np.array(
            [[26184461, 649988, 27490, 612601, 51243, 186284,
              2559, 38922, 1681, 5689, 8548, 6203,
              26386, 59440, 585, 3197, 4921, 12225,
              7763, 53917, 19837, 1961, 248, 3212,
              12431, 377, 50, 2142, 1806, 2258,
              1984, 1622, 12, 676, 187, 295,
              746, 1751, 2208, 1891, 617, 48,
              76, 964, 9, 522, 1831, 35,
              6, 7, 77, 108, 2, 38,
              10, 146, 1, 2, 20, 19,
              2, 21, 19, 24, 9, 0],
             [86140, 4001180, 228606, 1097794, 254428, 81381,
              10832, 71388, 17379, 78396, 70179, 22110,
              68828, 32231, 1373, 10788, 24330, 19866,
              18888, 8463, 68561, 5706, 662, 9110,
              12301, 2854, 77, 4293, 4181, 6238,
              2661, 5225, 350, 959, 4162, 4316,
              2189, 4374, 6467, 4826, 3154, 257,
              3481, 3032, 249, 1884, 5790, 600,
              180, 35, 595, 390, 619, 1053,
              228, 552, 71, 72, 53, 125,
              33, 129, 38, 42, 9, 2],
             [20513, 476029, 10457082, 664821, 362618, 31222,
              14690, 44499, 3904, 3916, 21388, 31645,
              45690, 3807, 191, 4487, 17470, 11973,
              10576, 1198, 32341, 2929, 167, 4348,
              1283, 255, 33, 6558, 5423, 5037,
              1676, 2766, 28, 284, 591, 537,
              1993, 4459, 2926, 3213, 1394, 44,
              265, 3093, 39, 1931, 3867, 33,
              11, 9, 118, 53, 34, 155,
              16, 53, 1, 2, 1, 11,
              1, 12, 9, 5, 7, 0],
             [449633, 1874577, 556032, 54863196, 1007703, 450317,
              40478, 572833, 210100, 209313, 159724, 109815,
              401058, 203193, 4070, 65539, 111615, 120059,
              98506, 34250, 577601, 27107, 5154, 57974,
              54415, 28793, 1023, 14711, 14182, 23447,
              10779, 24000, 3500, 7992, 45202, 29908,
              8048, 20079, 36236, 25736, 8177, 3361,
              5226, 11742, 1677, 6948, 25979, 4549,
              2711, 291, 2873, 784, 6710, 9673,
              1574, 1669, 855, 822, 48, 202,
              261, 907, 117, 164, 43, 4],
             [37254, 393142, 273798, 749200, 12167458, 37245,
              51538, 45823, 4418, 7861, 23822, 37591,
              56951, 6615, 316, 5665, 15455, 11961,
              11488, 2430, 35326, 3210, 213, 5493,
              3355, 710, 23, 8351, 4200, 3730,
              1331, 3080, 35, 517, 803, 654,
              1789, 4189, 3790, 3544, 1483, 4,
              408, 3065, 118, 1538, 3998, 58,
              93, 3, 849, 63, 76, 307,
              10, 78, 0, 23, 4, 16,
              0, 12, 8, 9, 19, 0],
             [121749, 134315, 23628, 322424, 31083, 3416112,
              1299, 48150, 812, 5163, 7360, 4420,
              11194, 79418, 381, 2572, 3285, 4789,
              6478, 8097, 23168, 911, 18, 3461,
              7788, 632, 1, 890, 804, 1750,
              1594, 954, 2, 87, 14, 1,
              360, 940, 1051, 1107, 280, 0,
              44, 604, 12, 261, 961, 18,
              0, 3, 8, 33, 1, 2,
              5, 118, 0, 1, 1, 2,
              0, 9, 92, 9, 3, 0],
             [73, 4115, 4205, 9780, 24930, 33,
              191982, 608, 33, 422, 314, 520,
              4356, 30, 0, 105, 280, 409,
              363, 28, 299, 53, 4, 57,
              22, 19, 0, 411, 53, 53,
              17, 64, 1, 4, 27, 1,
              42, 166, 90, 49, 31, 2,
              0, 126, 1, 20, 101, 0,
              1, 0, 1, 0, 0, 2,
              0, 1, 0, 0, 0, 0,
              0, 0, 0, 1, 0, 0],
             [14251, 66161, 17954, 232410, 21789, 24523,
              1525, 1794272, 11900, 3894, 12240, 3844,
              12304, 5959, 104, 2549, 6271, 4509,
              7837, 1471, 46121, 1214, 38, 2762,
              985, 321, 5, 1532, 1360, 1052,
              636, 1429, 63, 67, 2281, 1159,
              751, 1472, 1669, 2426, 769, 141,
              270, 1110, 149, 392, 1207, 96,
              40, 17, 84, 89, 182, 717,
              24, 54, 9, 45, 2, 25,
              14, 5, 4, 9, 0, 0],
             [484, 46072, 2115, 169585, 3232, 26,
              355, 21807, 1098779, 546, 2177, 487,
              3399, 33, 28, 899, 5178, 1792,
              16333, 36, 21357, 483, 589, 320,
              71, 162, 2, 256, 281, 342,
              436, 283, 2787, 10, 3384, 613,
              237, 562, 387, 662, 350, 21,
              0, 223, 1, 51, 647, 822,
              174, 206, 848, 6, 7933, 405,
              2590, 1, 404, 30, 0, 2,
              6, 0, 4, 0, 0, 0],
             [4283, 141966, 3866, 179302, 7937, 5130,
              2124, 7583, 1140, 4707925, 7699, 1292,
              7405, 834, 16, 925, 1479, 1285,
              1237, 322, 2785, 427, 297, 574,
              550, 25131, 2, 201, 160, 282,
              198, 358, 14, 94, 6270, 72,
              132, 530, 234, 323, 74, 579,
              6, 149, 1099, 85, 342, 7,
              4, 1, 48, 6, 6, 7,
              0, 7, 0, 23, 0, 1,
              185, 11, 1, 3, 0, 5],
             [7244, 122308, 20735, 157642, 25636, 8455,
              1087, 20994, 2810, 7357, 4809563, 4008,
              10021, 1640, 105, 2015, 4116, 5439,
              4302, 419, 13720, 1058, 67, 1742,
              2038, 927, 2, 1213, 877, 1119,
              430, 1177, 14, 466, 1145, 310,
              735, 2510, 1184, 1712, 747, 103,
              227, 1197, 232, 867, 1155, 39,
              18, 3, 26, 36, 33, 203,
              3, 33, 0, 4, 1, 4,
              3, 5, 1, 11, 14, 4],
             [1302, 22708, 9278, 57645, 19005, 2368,
              753, 2925, 62, 487, 1125, 584396,
              7176, 82, 26, 435, 777, 1551,
              718, 106, 1603, 241, 36, 554,
              308, 22, 0, 289, 268, 248,
              77, 249, 0, 68, 56, 7,
              97, 663, 255, 488, 148, 1,
              13, 113, 1, 99, 287, 1,
              0, 0, 0, 1, 0, 4,
              0, 4, 1, 0, 0, 0,
              0, 0, 2, 0, 0, 0],
             [16681, 106699, 36179, 285282, 47470, 9353,
              5640, 17355, 2904, 4987, 6729, 8074,
              3040975, 2721, 90, 4813, 12312, 7287,
              4636, 697, 12079, 1436, 153, 2298,
              1853, 499, 13, 1099, 955, 1490,
              665, 1281, 43, 331, 415, 929,
              512, 1856, 1730, 1812, 384, 32,
              75, 689, 38, 959, 1517, 102,
              38, 9, 44, 14, 43, 135,
              4, 18, 7, 0, 0, 4,
              2, 12, 1, 5, 4, 0],
             [74971, 105941, 6163, 264365, 9517, 120503,
              615, 15407, 383, 1012, 1989, 874,
              4679, 3713133, 52, 1120, 1394, 2517,
              4285, 9318, 9579, 578, 11, 818,
              2656, 13, 1, 856, 327, 558,
              2430, 355, 1, 19, 19, 19,
              137, 298, 830, 430, 83, 0,
              3, 343, 1, 145, 426, 2,
              0, 1, 6, 886, 0, 1,
              0, 15, 0, 0, 309, 342,
              0, 1, 23, 1, 2, 0],
             [348, 1761, 66, 3250, 138, 307,
              5, 139, 30, 28, 104, 34,
              63, 27, 43191, 18, 29, 48,
              29, 47, 66, 21, 4, 46,
              9687, 1, 0, 10, 6, 71,
              19, 11, 0, 7, 3, 0,
              29, 19, 9, 10, 38, 0,
              573, 6, 0, 1, 10, 0,
              0, 0, 0, 0, 0, 0,
              0, 282, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [67, 5570, 364, 19720, 1046, 102,
              102, 661, 23, 26, 408, 206,
              2122, 2, 14, 189184, 257, 1715,
              241, 24, 545, 296, 17, 159,
              50, 15, 0, 70, 59, 59,
              38, 265, 1, 5, 9, 4,
              30, 108, 147, 120, 22, 0,
              1, 62, 2, 32, 76, 1,
              0, 0, 0, 2, 1, 0,
              0, 2, 0, 1, 0, 0,
              1, 0, 0, 0, 0, 0],
             [18, 1254, 189, 2506, 293, 21,
              56, 382, 37, 21, 114, 98,
              1382, 1, 2, 75, 37059, 186,
              225, 24, 882, 60, 5, 79,
              22, 8, 0, 62, 41, 48,
              23, 51, 0, 5, 15, 12,
              24, 60, 59, 60, 37, 0,
              2, 34, 1, 17, 64, 2,
              2, 0, 5, 2, 3, 4,
              0, 1, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [5252, 18949, 6677, 63393, 7704, 3093,
              428, 4152, 692, 776, 2771, 1196,
              4776, 899, 32, 1429, 740, 548457,
              1174, 295, 3397, 632, 33, 723,
              702, 187, 2, 281, 237, 346,
              95, 556, 27, 74, 174, 57,
              114, 315, 721, 461, 151, 4,
              19, 183, 52, 161, 348, 8,
              4, 1, 3, 12, 5, 31,
              2, 18, 0, 2, 0, 1,
              0, 0, 1, 1, 0, 0],
             [88, 1555, 194, 3059, 297, 146,
              50, 1090, 949, 27, 159, 196,
              197, 20, 1, 100, 424, 116,
              29052, 28, 1543, 146, 1, 100,
              25, 5, 3, 55, 81, 146,
              30, 117, 1, 11, 37, 264,
              46, 137, 125, 267, 172, 3,
              6, 95, 1, 40, 72, 32,
              6, 2, 0, 2, 13, 758,
              3, 2, 0, 282, 0, 0,
              0, 0, 0, 0, 0, 0],
             [29963, 8729, 174, 18139, 590, 1841,
              29, 465, 17, 50, 85, 76,
              330, 995, 2, 45, 66, 148,
              75, 301910, 330, 63, 19, 34,
              173, 17, 0, 29, 25, 31,
              815, 17, 1, 9, 16, 0,
              7, 30, 29, 30, 7, 1,
              2, 19, 0, 18, 18, 0,
              0, 0, 1, 60, 0, 0,
              0, 2, 0, 0, 3, 14,
              0, 0, 0, 1, 0, 3],
             [1977, 55485, 5751, 182879, 13082, 5307,
              754, 25325, 2030, 112, 4911, 2714,
              4220, 1004, 1, 2077, 5214, 2521,
              4641, 303, 848579, 1067, 7, 2693,
              70, 15, 3, 1067, 936, 685,
              204, 1153, 8, 9, 133, 54,
              686, 1224, 1232, 1688, 432, 5,
              3, 706, 11, 337, 1357, 3,
              2, 1, 6, 16, 9, 42,
              10, 2, 1, 1, 0, 5,
              1, 5, 0, 0, 0, 0],
             [3, 439, 20, 1444, 62, 12,
              9, 58, 5, 4, 9, 22,
              48, 1, 0, 24, 22, 113,
              81, 1, 75, 21456, 0, 21,
              17, 5, 0, 15, 14, 42,
              8, 345, 0, 3, 13, 22,
              12, 19, 230, 22, 3, 0,
              1, 40, 0, 8, 17, 2,
              0, 0, 0, 0, 0, 0,
              0, 1, 0, 0, 0, 0,
              0, 0, 0, 1, 0, 0],
             [174, 2760, 66, 5934, 86, 8,
              11, 34, 2, 194, 30, 16,
              24, 0, 2, 15, 15, 35,
              8, 4, 16, 13, 108706, 5,
              70, 18, 0, 3, 1, 3,
              1, 5, 1, 0, 8, 4,
              1, 31, 5, 3, 1, 0,
              0, 4, 0, 0, 4, 1,
              0, 0, 2, 0, 1, 2,
              0, 1, 0, 0, 0, 1,
              0, 2, 0, 0, 0, 0],
             [1193, 14398, 1085, 38890, 3531, 3282,
              125, 2271, 40, 35, 885, 441,
              1348, 68, 74, 309, 271, 1073,
              422, 42, 770, 130, 19, 355241,
              676, 4, 0, 157, 164, 561,
              29, 112, 0, 31, 8, 1,
              81, 132, 266, 161, 165, 0,
              45, 193, 0, 42, 96, 0,
              0, 0, 1, 0, 0, 0,
              1, 5, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [11575, 27629, 2163, 56200, 4673, 8674,
              194, 2193, 160, 781, 1796, 863,
              2624, 1322, 10758, 289, 309, 1099,
              459, 553, 923, 169, 132, 595,
              830205, 276, 3, 103, 140, 730,
              104, 124, 2, 213, 142, 1,
              270, 199, 161, 246, 267, 0,
              3533, 76, 18, 49, 127, 4,
              1, 6, 3, 1, 8, 0,
              0, 2963, 0, 2, 0, 0,
              0, 3, 1, 42, 1, 1],
             [588, 17915, 379, 47692, 1281, 718,
              183, 827, 100, 50739, 1884, 176,
              1473, 2, 1, 79, 104, 436,
              154, 133, 168, 72, 89, 36,
              283, 946477, 0, 23, 20, 36,
              45, 18, 0, 2, 4282, 0,
              17, 55, 43, 30, 11, 629,
              0, 36, 623, 9, 40, 0,
              0, 1, 2, 0, 0, 0,
              0, 1, 0, 0, 0, 0,
              383, 0, 0, 0, 0, 0],
             [0, 363, 20, 1032, 209, 0,
              1, 68, 21, 26, 33, 7,
              23, 0, 0, 2, 7, 74,
              11, 1, 35, 0, 0, 2,
              0, 0, 5904, 8, 1, 4,
              1, 3, 1, 0, 4, 13,
              0, 1, 1, 0, 2, 0,
              0, 0, 0, 0, 1, 0,
              0, 0, 0, 0, 0, 1,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [7, 302, 48, 211, 870, 7,
              122, 38, 0, 0, 2, 17,
              49, 4, 0, 1, 6, 3,
              12, 1, 10, 3, 0, 2,
              1, 0, 0, 9833, 9, 8,
              5, 4, 0, 0, 2, 2,
              6, 6, 5, 12, 2, 0,
              0, 2, 0, 3, 3, 0,
              1, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [1, 74, 12, 143, 8, 8,
              2, 12, 2, 0, 18, 0,
              1, 1, 0, 1, 6, 7,
              3, 1, 7, 5, 0, 6,
              0, 0, 0, 2, 4329, 25,
              3, 3, 0, 0, 4, 1,
              25, 6, 5, 4, 3, 0,
              4, 3, 0, 3, 2, 1,
              0, 0, 1, 0, 0, 0,
              0, 0, 0, 0, 0, 1,
              0, 0, 0, 0, 0, 0],
             [184, 3490, 481, 6859, 724, 37,
              23, 482, 10, 2, 268, 74,
              320, 5, 31, 71, 103, 221,
              132, 7, 111, 39, 8, 647,
              106, 0, 0, 39, 123, 80193,
              71, 23, 0, 5, 6, 0,
              87, 23, 51, 38, 384, 0,
              18, 50, 0, 27, 19, 0,
              0, 1, 2, 0, 0, 1,
              1, 13, 0, 0, 0, 0,
              0, 0, 0, 2, 3, 0],
             [313, 1007, 55, 2037, 202, 670,
              5, 130, 6, 2, 18, 9,
              66, 423, 2, 13, 30, 32,
              23, 588, 81, 14, 0, 8,
              4, 10, 0, 6, 9, 16,
              23474, 10, 1, 0, 2, 4,
              1, 10, 8, 22, 2, 0,
              0, 15, 0, 5, 13, 1,
              0, 0, 2, 20, 1, 0,
              0, 0, 1, 0, 0, 20,
              0, 0, 0, 1, 0, 0],
             [2, 526, 23, 1827, 105, 5,
              10, 70, 5, 0, 28, 7,
              35, 0, 0, 30, 15, 69,
              12, 2, 21, 873, 0, 9,
              0, 0, 0, 4, 4, 4,
              1, 21045, 0, 2, 20, 1,
              2, 8, 361, 36, 4, 0,
              0, 7, 2, 17, 21, 1,
              0, 1, 0, 2, 1, 1,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [21, 1188, 27, 4057, 24, 30,
              13, 68, 883, 90, 20, 13,
              12, 0, 0, 5, 8, 6,
              22, 3, 62, 1, 0, 1,
              0, 2, 0, 3, 4, 3,
              3, 6, 45044, 0, 28, 4,
              8, 7, 2, 4, 0, 1,
              0, 0, 0, 1, 3, 0,
              0, 0, 2, 0, 78, 4,
              1, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [203, 4674, 209, 10444, 594, 16,
              36, 126, 6, 68, 221, 171,
              511, 0, 26, 29, 53, 154,
              34, 8, 55, 11, 6, 22,
              117, 2, 0, 10, 11, 19,
              3, 12, 0, 121416, 1, 0,
              5, 39, 14, 31, 12, 1,
              1, 6, 0, 2, 18, 0,
              0, 0, 0, 0, 0, 0,
              0, 3, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [236, 9447, 595, 39549, 963, 39,
              270, 4050, 5839, 6465, 967, 114,
              733, 31, 0, 162, 422, 278,
              838, 48, 1710, 107, 4, 90,
              11, 3722, 1, 41, 45, 71,
              23, 105, 9, 8, 328487, 12,
              30, 76, 27, 159, 35, 2935,
              0, 53, 14, 14, 63, 0,
              0, 11, 26, 1, 16, 19,
              0, 1, 0, 0, 0, 0,
              313, 1, 0, 0, 0, 0],
             [195, 8880, 609, 22259, 646, 16,
              65, 2729, 1567, 45, 586, 152,
              924, 0, 0, 85, 301, 184,
              2821, 1, 1379, 277, 12, 25,
              1, 2, 8, 56, 40, 48,
              79, 61, 0, 0, 8, 133135,
              78, 69, 156, 358, 18, 0,
              0, 66, 0, 68, 64, 34,
              106, 3, 17, 1, 82, 39,
              15, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [17, 254, 47, 557, 68, 3,
              1, 46, 0, 0, 3, 6,
              1, 0, 18, 7, 9, 30,
              21, 0, 38, 32, 0, 3,
              94, 0, 0, 1, 117, 3,
              0, 10, 0, 0, 0, 0,
              8749, 6, 4, 7, 6, 0,
              9, 16, 0, 1, 2, 0,
              0, 0, 1, 0, 0, 2,
              0, 1, 0, 0, 0, 0,
              0, 0, 0, 1, 0, 0],
             [6, 211, 92, 324, 75, 16,
              67, 127, 3, 30, 220, 48,
              62, 0, 0, 13, 23, 30,
              16, 1, 35, 21, 0, 2,
              5, 3, 0, 8, 12, 10,
              26, 2, 0, 8, 0, 0,
              3, 6659, 16, 83, 13, 0,
              1, 9, 14, 1, 79, 0,
              0, 0, 0, 0, 0, 2,
              1, 0, 1, 1, 0, 0,
              0, 0, 0, 0, 1, 0],
             [37, 3055, 273, 9610, 467, 10,
              44, 336, 31, 9, 70, 104,
              314, 13, 1, 63, 68, 313,
              84, 1, 121, 569, 1, 43,
              17, 4, 0, 14, 17, 15,
              1, 680, 0, 1, 0, 0,
              23, 29, 96580, 147, 14, 1,
              1, 31, 1, 49, 23, 0,
              0, 0, 1, 1, 1, 10,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [131, 1430, 120, 6226, 173, 47,
              9, 225, 33, 4, 31, 50,
              104, 1, 0, 30, 33, 92,
              400, 6, 53, 35, 2, 18,
              13, 1, 0, 15, 32, 8,
              2, 30, 0, 2, 0, 2,
              10, 19, 321, 73171, 6, 0,
              2, 16, 1, 6, 10, 0,
              0, 0, 0, 1, 0, 4,
              1, 0, 0, 1, 0, 0,
              0, 2, 0, 0, 0, 0],
             [1, 911, 44, 1179, 170, 0,
              3, 80, 5, 0, 20, 37,
              10, 0, 2, 7, 33, 137,
              33, 5, 47, 12, 2, 112,
              3, 0, 0, 11, 42, 148,
              2, 12, 0, 0, 0, 1,
              36, 7, 18, 12, 12426, 0,
              188, 7, 0, 7, 3, 1,
              0, 0, 0, 0, 0, 0,
              0, 9, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [0, 680, 115, 2194, 57, 0,
              27, 302, 63, 770, 5, 0,
              79, 0, 0, 6, 7, 15,
              17, 0, 23, 14, 0, 1,
              0, 1006, 0, 0, 0, 5,
              0, 1, 0, 0, 2189, 0,
              2, 9, 0, 1, 3, 15396,
              0, 0, 0, 0, 5, 0,
              0, 0, 1, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              6, 0, 0, 0, 0, 1],
             [8, 3042, 162, 3062, 265, 2,
              19, 238, 9, 3, 57, 119,
              120, 0, 422, 31, 64, 31,
              65, 0, 111, 24, 2, 267,
              2780, 0, 0, 21, 91, 197,
              0, 24, 0, 7, 0, 0,
              98, 24, 25, 15, 682, 0,
              24984, 13, 0, 10, 5, 0,
              0, 0, 0, 0, 0, 0,
              0, 2144, 0, 0, 0, 0,
              0, 0, 0, 1, 0, 0],
             [41, 272, 12, 675, 26, 46,
              6, 68, 4, 0, 9, 10,
              23, 2, 0, 17, 42, 30,
              24, 1, 97, 23, 0, 8,
              0, 1, 0, 2, 15, 13,
              2, 13, 0, 0, 0, 0,
              17, 3, 13, 5, 3, 0,
              0, 7079, 0, 3, 8, 0,
              0, 0, 1, 1, 0, 1,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [0, 456, 15, 773, 27, 1,
              11, 225, 10, 696, 262, 7,
              25, 0, 0, 5, 30, 17,
              18, 0, 64, 3, 4, 15,
              3, 736, 0, 2, 4, 2,
              3, 2, 0, 1, 0, 0,
              0, 29, 5, 13, 4, 0,
              0, 2, 6702, 0, 15, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [1, 149, 33, 368, 7, 1,
              0, 18, 0, 0, 2, 4,
              4, 0, 1, 1, 2, 10,
              2, 0, 3, 8, 0, 0,
              2, 0, 0, 1, 1, 1,
              0, 6, 0, 0, 0, 1,
              0, 4, 4, 3, 0, 0,
              0, 0, 0, 5104, 3, 0,
              0, 0, 1, 0, 0, 0,
              1, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [55, 183, 20, 546, 61, 6,
              29, 21, 4, 0, 6, 8,
              48, 2, 0, 10, 23, 13,
              13, 1, 27, 4, 0, 3,
              0, 0, 0, 0, 0, 2,
              3, 16, 0, 0, 0, 0,
              1, 15, 5, 23, 1, 0,
              0, 8, 0, 5, 7567, 0,
              0, 0, 1, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [1, 913, 5, 2782, 47, 0,
              12, 123, 513, 0, 18, 7,
              50, 0, 0, 9, 17, 7,
              116, 1, 42, 9, 10, 1,
              0, 0, 0, 14, 1, 0,
              35, 14, 1, 0, 1, 9,
              3, 2, 5, 1, 2, 0,
              0, 0, 0, 1, 4, 16095,
              5, 0, 4, 0, 38, 22,
              6, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [10, 920, 13, 2961, 56, 0,
              4, 167, 244, 6, 51, 7,
              11, 0, 0, 5, 19, 21,
              58, 2, 41, 15, 7, 2,
              0, 0, 0, 13, 3, 3,
              2, 2, 1, 0, 0, 21,
              0, 6, 2, 9, 1, 0,
              0, 5, 0, 0, 2, 1,
              19699, 0, 2, 0, 3, 1,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [0, 20, 4, 55, 0, 0,
              0, 11, 57, 0, 0, 0,
              0, 0, 0, 0, 1, 0,
              7, 0, 3, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 2,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 1,
              0, 451, 1, 0, 2, 0,
              1, 0, 2, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [88, 1105, 175, 2012, 688, 0,
              15, 142, 290, 100, 37, 7,
              97, 2, 9, 4, 16, 8,
              39, 6, 48, 6, 3, 4,
              1, 34, 0, 21, 2, 304,
              90, 6, 6, 2, 125, 7,
              1, 7, 2, 8, 1, 4,
              0, 1, 0, 2, 7, 48,
              2, 0, 26303, 1, 7, 2,
              2, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [28, 345, 7, 287, 36, 13,
              1, 19, 7, 1, 12, 2,
              3, 188, 0, 0, 1, 0,
              4, 76, 19, 6, 0, 1,
              0, 0, 0, 1, 1, 2,
              33, 3, 0, 0, 0, 1,
              0, 0, 0, 2, 0, 0,
              0, 1, 0, 2, 2, 0,
              0, 0, 0, 5149, 0, 0,
              0, 0, 0, 0, 2, 41,
              0, 0, 0, 0, 0, 0],
             [2, 1207, 28, 4035, 19, 0,
              5, 121, 3094, 8, 11, 1,
              68, 37, 2, 8, 26, 16,
              54, 0, 77, 4, 5, 0,
              0, 0, 0, 2, 2, 2,
              0, 5, 103, 0, 0, 12,
              0, 4, 3, 2, 2, 0,
              0, 3, 0, 0, 8, 7,
              3, 5, 7, 0, 28810, 13,
              15, 0, 6, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [5, 1939, 85, 6224, 191, 0,
              16, 943, 686, 9, 177, 76,
              135, 0, 0, 21, 111, 52,
              1392, 1, 364, 19, 6, 12,
              0, 1, 0, 14, 33, 9,
              20, 18, 1, 0, 5, 40,
              36, 20, 25, 65, 15, 0,
              0, 5, 0, 18, 27, 38,
              2, 0, 1, 0, 74, 34636,
              9, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [0, 173, 1, 498, 6, 0,
              0, 36, 717, 0, 0, 0,
              9, 0, 0, 2, 7, 1,
              15, 0, 15, 0, 0, 2,
              0, 0, 0, 1, 0, 1,
              1, 0, 3, 0, 0, 0,
              0, 1, 0, 0, 1, 0,
              0, 1, 0, 0, 0, 0,
              0, 1, 0, 0, 6, 0,
              5271, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [0, 154, 5, 259, 0, 7,
              0, 9, 1, 0, 3, 3,
              11, 0, 54, 1, 1, 3,
              2, 1, 8, 1, 0, 4,
              374, 0, 0, 2, 1, 4,
              0, 0, 0, 0, 0, 0,
              0, 2, 0, 0, 6, 0,
              77, 0, 0, 0, 1, 0,
              0, 0, 0, 0, 0, 0,
              0, 3346, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [0, 117, 1, 399, 0, 0,
              2, 15, 112, 0, 0, 1,
              0, 0, 0, 0, 0, 1,
              8, 0, 5, 1, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 3, 0, 0, 0, 0,
              0, 1, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 8, 0,
              0, 0, 2640, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [0, 58, 0, 212, 9, 0,
              1, 46, 62, 17, 33, 5,
              0, 0, 0, 4, 3, 1,
              193, 0, 10, 2, 0, 0,
              0, 0, 0, 0, 0, 1,
              0, 1, 0, 0, 0, 0,
              1, 3, 0, 13, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 2, 0, 0, 0,
              0, 0, 0, 1289, 0, 0,
              0, 0, 0, 0, 0, 0],
             [0, 18, 0, 3, 0, 0,
              0, 1, 0, 0, 0, 0,
              0, 43, 0, 0, 0, 0,
              0, 2, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 1,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 414, 0,
              0, 0, 0, 0, 0, 0],
             [1, 57, 2, 44, 3, 1,
              0, 3, 0, 0, 1, 0,
              0, 37, 0, 0, 2, 0,
              2, 17, 5, 1, 0, 0,
              0, 0, 0, 0, 0, 0,
              17, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 15, 0, 0,
              0, 0, 0, 0, 0, 1021,
              0, 0, 0, 0, 0, 0],
             [0, 80, 3, 136, 0, 0,
              1, 9, 5, 121, 0, 0,
              0, 0, 0, 1, 0, 0,
              1, 0, 4, 0, 0, 0,
              0, 8, 0, 0, 0, 0,
              0, 0, 0, 0, 143, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              768, 0, 0, 0, 0, 0],
             [0, 121, 0, 335, 0, 0,
              3, 14, 4, 0, 19, 2,
              2, 0, 0, 0, 4, 11,
              7, 0, 3, 2, 0, 0,
              0, 0, 0, 2, 0, 0,
              2, 0, 0, 0, 0, 0,
              0, 0, 3, 2, 0, 0,
              0, 0, 0, 1, 2, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 1702, 0, 0, 0, 0],
             [0, 0, 0, 4, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 45, 0, 0, 0],
             [0, 25, 2, 46, 0, 1,
              1, 8, 0, 2, 1, 1,
              5, 0, 0, 0, 0, 0,
              2, 0, 3, 1, 0, 0,
              21, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 1, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 526, 0, 0],
             [0, 1, 0, 2, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 63, 0],
             [0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 2]])

    def create_feature(self):
        engager_main_language_feature = EngagerMainLanguage(self.dataset_id)
        tweet_language_feature = MappedFeatureTweetLanguage(self.dataset_id)

        engager_main_language_df = engager_main_language_feature.load_or_create()
        tweet_language_df = tweet_language_feature.load_or_create()

        statistical_data = self.statistical_data.astype(np.float)

        # remove the main language
        for row in range(statistical_data.shape[0]):
            statistical_data[row][row] = 0
            break

        # normalize all the data
        for row in range(statistical_data.shape[0]):
            if statistical_data[row].sum() > 0:
                statistical_data[row] = statistical_data[row] / statistical_data[row].sum()

        result = pd.DataFrame(
            [statistical_data[x][y]
             for x, y
             in zip(engager_main_language_df[engager_main_language_feature.feature_name],
                    tweet_language_df[tweet_language_feature.feature_name])]
        )

        self.save_feature(result)


class StatisticalProbabilityMainLanguageOfEngagerEngageTweetLanguage2(GeneratedFeaturePickle):

    def __init__(self, dataset_id: str):
        super().__init__("statistical_probability_main_language_of_engager_engage_tweet_language_2", dataset_id)
        self.pck_path = pl.Path(
            f"{Feature.ROOT_PATH}/{self.dataset_id}/generated/main_language/{self.feature_name}.pck.gz")
        self.csv_path = pl.Path(
            f"{Feature.ROOT_PATH}/{self.dataset_id}/generated/main_language/{self.feature_name}.csv.gz")
        self.statistical_data = np.array(66)
        self.statistical_data = np.array(
            [[26184461, 649988, 27490, 612601, 51243, 186284,
              2559, 38922, 1681, 5689, 8548, 6203,
              26386, 59440, 585, 3197, 4921, 12225,
              7763, 53917, 19837, 1961, 248, 3212,
              12431, 377, 50, 2142, 1806, 2258,
              1984, 1622, 12, 676, 187, 295,
              746, 1751, 2208, 1891, 617, 48,
              76, 964, 9, 522, 1831, 35,
              6, 7, 77, 108, 2, 38,
              10, 146, 1, 2, 20, 19,
              2, 21, 19, 24, 9, 0],
             [86140, 4001180, 228606, 1097794, 254428, 81381,
              10832, 71388, 17379, 78396, 70179, 22110,
              68828, 32231, 1373, 10788, 24330, 19866,
              18888, 8463, 68561, 5706, 662, 9110,
              12301, 2854, 77, 4293, 4181, 6238,
              2661, 5225, 350, 959, 4162, 4316,
              2189, 4374, 6467, 4826, 3154, 257,
              3481, 3032, 249, 1884, 5790, 600,
              180, 35, 595, 390, 619, 1053,
              228, 552, 71, 72, 53, 125,
              33, 129, 38, 42, 9, 2],
             [20513, 476029, 10457082, 664821, 362618, 31222,
              14690, 44499, 3904, 3916, 21388, 31645,
              45690, 3807, 191, 4487, 17470, 11973,
              10576, 1198, 32341, 2929, 167, 4348,
              1283, 255, 33, 6558, 5423, 5037,
              1676, 2766, 28, 284, 591, 537,
              1993, 4459, 2926, 3213, 1394, 44,
              265, 3093, 39, 1931, 3867, 33,
              11, 9, 118, 53, 34, 155,
              16, 53, 1, 2, 1, 11,
              1, 12, 9, 5, 7, 0],
             [449633, 1874577, 556032, 54863196, 1007703, 450317,
              40478, 572833, 210100, 209313, 159724, 109815,
              401058, 203193, 4070, 65539, 111615, 120059,
              98506, 34250, 577601, 27107, 5154, 57974,
              54415, 28793, 1023, 14711, 14182, 23447,
              10779, 24000, 3500, 7992, 45202, 29908,
              8048, 20079, 36236, 25736, 8177, 3361,
              5226, 11742, 1677, 6948, 25979, 4549,
              2711, 291, 2873, 784, 6710, 9673,
              1574, 1669, 855, 822, 48, 202,
              261, 907, 117, 164, 43, 4],
             [37254, 393142, 273798, 749200, 12167458, 37245,
              51538, 45823, 4418, 7861, 23822, 37591,
              56951, 6615, 316, 5665, 15455, 11961,
              11488, 2430, 35326, 3210, 213, 5493,
              3355, 710, 23, 8351, 4200, 3730,
              1331, 3080, 35, 517, 803, 654,
              1789, 4189, 3790, 3544, 1483, 4,
              408, 3065, 118, 1538, 3998, 58,
              93, 3, 849, 63, 76, 307,
              10, 78, 0, 23, 4, 16,
              0, 12, 8, 9, 19, 0],
             [121749, 134315, 23628, 322424, 31083, 3416112,
              1299, 48150, 812, 5163, 7360, 4420,
              11194, 79418, 381, 2572, 3285, 4789,
              6478, 8097, 23168, 911, 18, 3461,
              7788, 632, 1, 890, 804, 1750,
              1594, 954, 2, 87, 14, 1,
              360, 940, 1051, 1107, 280, 0,
              44, 604, 12, 261, 961, 18,
              0, 3, 8, 33, 1, 2,
              5, 118, 0, 1, 1, 2,
              0, 9, 92, 9, 3, 0],
             [73, 4115, 4205, 9780, 24930, 33,
              191982, 608, 33, 422, 314, 520,
              4356, 30, 0, 105, 280, 409,
              363, 28, 299, 53, 4, 57,
              22, 19, 0, 411, 53, 53,
              17, 64, 1, 4, 27, 1,
              42, 166, 90, 49, 31, 2,
              0, 126, 1, 20, 101, 0,
              1, 0, 1, 0, 0, 2,
              0, 1, 0, 0, 0, 0,
              0, 0, 0, 1, 0, 0],
             [14251, 66161, 17954, 232410, 21789, 24523,
              1525, 1794272, 11900, 3894, 12240, 3844,
              12304, 5959, 104, 2549, 6271, 4509,
              7837, 1471, 46121, 1214, 38, 2762,
              985, 321, 5, 1532, 1360, 1052,
              636, 1429, 63, 67, 2281, 1159,
              751, 1472, 1669, 2426, 769, 141,
              270, 1110, 149, 392, 1207, 96,
              40, 17, 84, 89, 182, 717,
              24, 54, 9, 45, 2, 25,
              14, 5, 4, 9, 0, 0],
             [484, 46072, 2115, 169585, 3232, 26,
              355, 21807, 1098779, 546, 2177, 487,
              3399, 33, 28, 899, 5178, 1792,
              16333, 36, 21357, 483, 589, 320,
              71, 162, 2, 256, 281, 342,
              436, 283, 2787, 10, 3384, 613,
              237, 562, 387, 662, 350, 21,
              0, 223, 1, 51, 647, 822,
              174, 206, 848, 6, 7933, 405,
              2590, 1, 404, 30, 0, 2,
              6, 0, 4, 0, 0, 0],
             [4283, 141966, 3866, 179302, 7937, 5130,
              2124, 7583, 1140, 4707925, 7699, 1292,
              7405, 834, 16, 925, 1479, 1285,
              1237, 322, 2785, 427, 297, 574,
              550, 25131, 2, 201, 160, 282,
              198, 358, 14, 94, 6270, 72,
              132, 530, 234, 323, 74, 579,
              6, 149, 1099, 85, 342, 7,
              4, 1, 48, 6, 6, 7,
              0, 7, 0, 23, 0, 1,
              185, 11, 1, 3, 0, 5],
             [7244, 122308, 20735, 157642, 25636, 8455,
              1087, 20994, 2810, 7357, 4809563, 4008,
              10021, 1640, 105, 2015, 4116, 5439,
              4302, 419, 13720, 1058, 67, 1742,
              2038, 927, 2, 1213, 877, 1119,
              430, 1177, 14, 466, 1145, 310,
              735, 2510, 1184, 1712, 747, 103,
              227, 1197, 232, 867, 1155, 39,
              18, 3, 26, 36, 33, 203,
              3, 33, 0, 4, 1, 4,
              3, 5, 1, 11, 14, 4],
             [1302, 22708, 9278, 57645, 19005, 2368,
              753, 2925, 62, 487, 1125, 584396,
              7176, 82, 26, 435, 777, 1551,
              718, 106, 1603, 241, 36, 554,
              308, 22, 0, 289, 268, 248,
              77, 249, 0, 68, 56, 7,
              97, 663, 255, 488, 148, 1,
              13, 113, 1, 99, 287, 1,
              0, 0, 0, 1, 0, 4,
              0, 4, 1, 0, 0, 0,
              0, 0, 2, 0, 0, 0],
             [16681, 106699, 36179, 285282, 47470, 9353,
              5640, 17355, 2904, 4987, 6729, 8074,
              3040975, 2721, 90, 4813, 12312, 7287,
              4636, 697, 12079, 1436, 153, 2298,
              1853, 499, 13, 1099, 955, 1490,
              665, 1281, 43, 331, 415, 929,
              512, 1856, 1730, 1812, 384, 32,
              75, 689, 38, 959, 1517, 102,
              38, 9, 44, 14, 43, 135,
              4, 18, 7, 0, 0, 4,
              2, 12, 1, 5, 4, 0],
             [74971, 105941, 6163, 264365, 9517, 120503,
              615, 15407, 383, 1012, 1989, 874,
              4679, 3713133, 52, 1120, 1394, 2517,
              4285, 9318, 9579, 578, 11, 818,
              2656, 13, 1, 856, 327, 558,
              2430, 355, 1, 19, 19, 19,
              137, 298, 830, 430, 83, 0,
              3, 343, 1, 145, 426, 2,
              0, 1, 6, 886, 0, 1,
              0, 15, 0, 0, 309, 342,
              0, 1, 23, 1, 2, 0],
             [348, 1761, 66, 3250, 138, 307,
              5, 139, 30, 28, 104, 34,
              63, 27, 43191, 18, 29, 48,
              29, 47, 66, 21, 4, 46,
              9687, 1, 0, 10, 6, 71,
              19, 11, 0, 7, 3, 0,
              29, 19, 9, 10, 38, 0,
              573, 6, 0, 1, 10, 0,
              0, 0, 0, 0, 0, 0,
              0, 282, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [67, 5570, 364, 19720, 1046, 102,
              102, 661, 23, 26, 408, 206,
              2122, 2, 14, 189184, 257, 1715,
              241, 24, 545, 296, 17, 159,
              50, 15, 0, 70, 59, 59,
              38, 265, 1, 5, 9, 4,
              30, 108, 147, 120, 22, 0,
              1, 62, 2, 32, 76, 1,
              0, 0, 0, 2, 1, 0,
              0, 2, 0, 1, 0, 0,
              1, 0, 0, 0, 0, 0],
             [18, 1254, 189, 2506, 293, 21,
              56, 382, 37, 21, 114, 98,
              1382, 1, 2, 75, 37059, 186,
              225, 24, 882, 60, 5, 79,
              22, 8, 0, 62, 41, 48,
              23, 51, 0, 5, 15, 12,
              24, 60, 59, 60, 37, 0,
              2, 34, 1, 17, 64, 2,
              2, 0, 5, 2, 3, 4,
              0, 1, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [5252, 18949, 6677, 63393, 7704, 3093,
              428, 4152, 692, 776, 2771, 1196,
              4776, 899, 32, 1429, 740, 548457,
              1174, 295, 3397, 632, 33, 723,
              702, 187, 2, 281, 237, 346,
              95, 556, 27, 74, 174, 57,
              114, 315, 721, 461, 151, 4,
              19, 183, 52, 161, 348, 8,
              4, 1, 3, 12, 5, 31,
              2, 18, 0, 2, 0, 1,
              0, 0, 1, 1, 0, 0],
             [88, 1555, 194, 3059, 297, 146,
              50, 1090, 949, 27, 159, 196,
              197, 20, 1, 100, 424, 116,
              29052, 28, 1543, 146, 1, 100,
              25, 5, 3, 55, 81, 146,
              30, 117, 1, 11, 37, 264,
              46, 137, 125, 267, 172, 3,
              6, 95, 1, 40, 72, 32,
              6, 2, 0, 2, 13, 758,
              3, 2, 0, 282, 0, 0,
              0, 0, 0, 0, 0, 0],
             [29963, 8729, 174, 18139, 590, 1841,
              29, 465, 17, 50, 85, 76,
              330, 995, 2, 45, 66, 148,
              75, 301910, 330, 63, 19, 34,
              173, 17, 0, 29, 25, 31,
              815, 17, 1, 9, 16, 0,
              7, 30, 29, 30, 7, 1,
              2, 19, 0, 18, 18, 0,
              0, 0, 1, 60, 0, 0,
              0, 2, 0, 0, 3, 14,
              0, 0, 0, 1, 0, 3],
             [1977, 55485, 5751, 182879, 13082, 5307,
              754, 25325, 2030, 112, 4911, 2714,
              4220, 1004, 1, 2077, 5214, 2521,
              4641, 303, 848579, 1067, 7, 2693,
              70, 15, 3, 1067, 936, 685,
              204, 1153, 8, 9, 133, 54,
              686, 1224, 1232, 1688, 432, 5,
              3, 706, 11, 337, 1357, 3,
              2, 1, 6, 16, 9, 42,
              10, 2, 1, 1, 0, 5,
              1, 5, 0, 0, 0, 0],
             [3, 439, 20, 1444, 62, 12,
              9, 58, 5, 4, 9, 22,
              48, 1, 0, 24, 22, 113,
              81, 1, 75, 21456, 0, 21,
              17, 5, 0, 15, 14, 42,
              8, 345, 0, 3, 13, 22,
              12, 19, 230, 22, 3, 0,
              1, 40, 0, 8, 17, 2,
              0, 0, 0, 0, 0, 0,
              0, 1, 0, 0, 0, 0,
              0, 0, 0, 1, 0, 0],
             [174, 2760, 66, 5934, 86, 8,
              11, 34, 2, 194, 30, 16,
              24, 0, 2, 15, 15, 35,
              8, 4, 16, 13, 108706, 5,
              70, 18, 0, 3, 1, 3,
              1, 5, 1, 0, 8, 4,
              1, 31, 5, 3, 1, 0,
              0, 4, 0, 0, 4, 1,
              0, 0, 2, 0, 1, 2,
              0, 1, 0, 0, 0, 1,
              0, 2, 0, 0, 0, 0],
             [1193, 14398, 1085, 38890, 3531, 3282,
              125, 2271, 40, 35, 885, 441,
              1348, 68, 74, 309, 271, 1073,
              422, 42, 770, 130, 19, 355241,
              676, 4, 0, 157, 164, 561,
              29, 112, 0, 31, 8, 1,
              81, 132, 266, 161, 165, 0,
              45, 193, 0, 42, 96, 0,
              0, 0, 1, 0, 0, 0,
              1, 5, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [11575, 27629, 2163, 56200, 4673, 8674,
              194, 2193, 160, 781, 1796, 863,
              2624, 1322, 10758, 289, 309, 1099,
              459, 553, 923, 169, 132, 595,
              830205, 276, 3, 103, 140, 730,
              104, 124, 2, 213, 142, 1,
              270, 199, 161, 246, 267, 0,
              3533, 76, 18, 49, 127, 4,
              1, 6, 3, 1, 8, 0,
              0, 2963, 0, 2, 0, 0,
              0, 3, 1, 42, 1, 1],
             [588, 17915, 379, 47692, 1281, 718,
              183, 827, 100, 50739, 1884, 176,
              1473, 2, 1, 79, 104, 436,
              154, 133, 168, 72, 89, 36,
              283, 946477, 0, 23, 20, 36,
              45, 18, 0, 2, 4282, 0,
              17, 55, 43, 30, 11, 629,
              0, 36, 623, 9, 40, 0,
              0, 1, 2, 0, 0, 0,
              0, 1, 0, 0, 0, 0,
              383, 0, 0, 0, 0, 0],
             [0, 363, 20, 1032, 209, 0,
              1, 68, 21, 26, 33, 7,
              23, 0, 0, 2, 7, 74,
              11, 1, 35, 0, 0, 2,
              0, 0, 5904, 8, 1, 4,
              1, 3, 1, 0, 4, 13,
              0, 1, 1, 0, 2, 0,
              0, 0, 0, 0, 1, 0,
              0, 0, 0, 0, 0, 1,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [7, 302, 48, 211, 870, 7,
              122, 38, 0, 0, 2, 17,
              49, 4, 0, 1, 6, 3,
              12, 1, 10, 3, 0, 2,
              1, 0, 0, 9833, 9, 8,
              5, 4, 0, 0, 2, 2,
              6, 6, 5, 12, 2, 0,
              0, 2, 0, 3, 3, 0,
              1, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [1, 74, 12, 143, 8, 8,
              2, 12, 2, 0, 18, 0,
              1, 1, 0, 1, 6, 7,
              3, 1, 7, 5, 0, 6,
              0, 0, 0, 2, 4329, 25,
              3, 3, 0, 0, 4, 1,
              25, 6, 5, 4, 3, 0,
              4, 3, 0, 3, 2, 1,
              0, 0, 1, 0, 0, 0,
              0, 0, 0, 0, 0, 1,
              0, 0, 0, 0, 0, 0],
             [184, 3490, 481, 6859, 724, 37,
              23, 482, 10, 2, 268, 74,
              320, 5, 31, 71, 103, 221,
              132, 7, 111, 39, 8, 647,
              106, 0, 0, 39, 123, 80193,
              71, 23, 0, 5, 6, 0,
              87, 23, 51, 38, 384, 0,
              18, 50, 0, 27, 19, 0,
              0, 1, 2, 0, 0, 1,
              1, 13, 0, 0, 0, 0,
              0, 0, 0, 2, 3, 0],
             [313, 1007, 55, 2037, 202, 670,
              5, 130, 6, 2, 18, 9,
              66, 423, 2, 13, 30, 32,
              23, 588, 81, 14, 0, 8,
              4, 10, 0, 6, 9, 16,
              23474, 10, 1, 0, 2, 4,
              1, 10, 8, 22, 2, 0,
              0, 15, 0, 5, 13, 1,
              0, 0, 2, 20, 1, 0,
              0, 0, 1, 0, 0, 20,
              0, 0, 0, 1, 0, 0],
             [2, 526, 23, 1827, 105, 5,
              10, 70, 5, 0, 28, 7,
              35, 0, 0, 30, 15, 69,
              12, 2, 21, 873, 0, 9,
              0, 0, 0, 4, 4, 4,
              1, 21045, 0, 2, 20, 1,
              2, 8, 361, 36, 4, 0,
              0, 7, 2, 17, 21, 1,
              0, 1, 0, 2, 1, 1,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [21, 1188, 27, 4057, 24, 30,
              13, 68, 883, 90, 20, 13,
              12, 0, 0, 5, 8, 6,
              22, 3, 62, 1, 0, 1,
              0, 2, 0, 3, 4, 3,
              3, 6, 45044, 0, 28, 4,
              8, 7, 2, 4, 0, 1,
              0, 0, 0, 1, 3, 0,
              0, 0, 2, 0, 78, 4,
              1, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [203, 4674, 209, 10444, 594, 16,
              36, 126, 6, 68, 221, 171,
              511, 0, 26, 29, 53, 154,
              34, 8, 55, 11, 6, 22,
              117, 2, 0, 10, 11, 19,
              3, 12, 0, 121416, 1, 0,
              5, 39, 14, 31, 12, 1,
              1, 6, 0, 2, 18, 0,
              0, 0, 0, 0, 0, 0,
              0, 3, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [236, 9447, 595, 39549, 963, 39,
              270, 4050, 5839, 6465, 967, 114,
              733, 31, 0, 162, 422, 278,
              838, 48, 1710, 107, 4, 90,
              11, 3722, 1, 41, 45, 71,
              23, 105, 9, 8, 328487, 12,
              30, 76, 27, 159, 35, 2935,
              0, 53, 14, 14, 63, 0,
              0, 11, 26, 1, 16, 19,
              0, 1, 0, 0, 0, 0,
              313, 1, 0, 0, 0, 0],
             [195, 8880, 609, 22259, 646, 16,
              65, 2729, 1567, 45, 586, 152,
              924, 0, 0, 85, 301, 184,
              2821, 1, 1379, 277, 12, 25,
              1, 2, 8, 56, 40, 48,
              79, 61, 0, 0, 8, 133135,
              78, 69, 156, 358, 18, 0,
              0, 66, 0, 68, 64, 34,
              106, 3, 17, 1, 82, 39,
              15, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [17, 254, 47, 557, 68, 3,
              1, 46, 0, 0, 3, 6,
              1, 0, 18, 7, 9, 30,
              21, 0, 38, 32, 0, 3,
              94, 0, 0, 1, 117, 3,
              0, 10, 0, 0, 0, 0,
              8749, 6, 4, 7, 6, 0,
              9, 16, 0, 1, 2, 0,
              0, 0, 1, 0, 0, 2,
              0, 1, 0, 0, 0, 0,
              0, 0, 0, 1, 0, 0],
             [6, 211, 92, 324, 75, 16,
              67, 127, 3, 30, 220, 48,
              62, 0, 0, 13, 23, 30,
              16, 1, 35, 21, 0, 2,
              5, 3, 0, 8, 12, 10,
              26, 2, 0, 8, 0, 0,
              3, 6659, 16, 83, 13, 0,
              1, 9, 14, 1, 79, 0,
              0, 0, 0, 0, 0, 2,
              1, 0, 1, 1, 0, 0,
              0, 0, 0, 0, 1, 0],
             [37, 3055, 273, 9610, 467, 10,
              44, 336, 31, 9, 70, 104,
              314, 13, 1, 63, 68, 313,
              84, 1, 121, 569, 1, 43,
              17, 4, 0, 14, 17, 15,
              1, 680, 0, 1, 0, 0,
              23, 29, 96580, 147, 14, 1,
              1, 31, 1, 49, 23, 0,
              0, 0, 1, 1, 1, 10,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [131, 1430, 120, 6226, 173, 47,
              9, 225, 33, 4, 31, 50,
              104, 1, 0, 30, 33, 92,
              400, 6, 53, 35, 2, 18,
              13, 1, 0, 15, 32, 8,
              2, 30, 0, 2, 0, 2,
              10, 19, 321, 73171, 6, 0,
              2, 16, 1, 6, 10, 0,
              0, 0, 0, 1, 0, 4,
              1, 0, 0, 1, 0, 0,
              0, 2, 0, 0, 0, 0],
             [1, 911, 44, 1179, 170, 0,
              3, 80, 5, 0, 20, 37,
              10, 0, 2, 7, 33, 137,
              33, 5, 47, 12, 2, 112,
              3, 0, 0, 11, 42, 148,
              2, 12, 0, 0, 0, 1,
              36, 7, 18, 12, 12426, 0,
              188, 7, 0, 7, 3, 1,
              0, 0, 0, 0, 0, 0,
              0, 9, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [0, 680, 115, 2194, 57, 0,
              27, 302, 63, 770, 5, 0,
              79, 0, 0, 6, 7, 15,
              17, 0, 23, 14, 0, 1,
              0, 1006, 0, 0, 0, 5,
              0, 1, 0, 0, 2189, 0,
              2, 9, 0, 1, 3, 15396,
              0, 0, 0, 0, 5, 0,
              0, 0, 1, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              6, 0, 0, 0, 0, 1],
             [8, 3042, 162, 3062, 265, 2,
              19, 238, 9, 3, 57, 119,
              120, 0, 422, 31, 64, 31,
              65, 0, 111, 24, 2, 267,
              2780, 0, 0, 21, 91, 197,
              0, 24, 0, 7, 0, 0,
              98, 24, 25, 15, 682, 0,
              24984, 13, 0, 10, 5, 0,
              0, 0, 0, 0, 0, 0,
              0, 2144, 0, 0, 0, 0,
              0, 0, 0, 1, 0, 0],
             [41, 272, 12, 675, 26, 46,
              6, 68, 4, 0, 9, 10,
              23, 2, 0, 17, 42, 30,
              24, 1, 97, 23, 0, 8,
              0, 1, 0, 2, 15, 13,
              2, 13, 0, 0, 0, 0,
              17, 3, 13, 5, 3, 0,
              0, 7079, 0, 3, 8, 0,
              0, 0, 1, 1, 0, 1,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [0, 456, 15, 773, 27, 1,
              11, 225, 10, 696, 262, 7,
              25, 0, 0, 5, 30, 17,
              18, 0, 64, 3, 4, 15,
              3, 736, 0, 2, 4, 2,
              3, 2, 0, 1, 0, 0,
              0, 29, 5, 13, 4, 0,
              0, 2, 6702, 0, 15, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [1, 149, 33, 368, 7, 1,
              0, 18, 0, 0, 2, 4,
              4, 0, 1, 1, 2, 10,
              2, 0, 3, 8, 0, 0,
              2, 0, 0, 1, 1, 1,
              0, 6, 0, 0, 0, 1,
              0, 4, 4, 3, 0, 0,
              0, 0, 0, 5104, 3, 0,
              0, 0, 1, 0, 0, 0,
              1, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [55, 183, 20, 546, 61, 6,
              29, 21, 4, 0, 6, 8,
              48, 2, 0, 10, 23, 13,
              13, 1, 27, 4, 0, 3,
              0, 0, 0, 0, 0, 2,
              3, 16, 0, 0, 0, 0,
              1, 15, 5, 23, 1, 0,
              0, 8, 0, 5, 7567, 0,
              0, 0, 1, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [1, 913, 5, 2782, 47, 0,
              12, 123, 513, 0, 18, 7,
              50, 0, 0, 9, 17, 7,
              116, 1, 42, 9, 10, 1,
              0, 0, 0, 14, 1, 0,
              35, 14, 1, 0, 1, 9,
              3, 2, 5, 1, 2, 0,
              0, 0, 0, 1, 4, 16095,
              5, 0, 4, 0, 38, 22,
              6, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [10, 920, 13, 2961, 56, 0,
              4, 167, 244, 6, 51, 7,
              11, 0, 0, 5, 19, 21,
              58, 2, 41, 15, 7, 2,
              0, 0, 0, 13, 3, 3,
              2, 2, 1, 0, 0, 21,
              0, 6, 2, 9, 1, 0,
              0, 5, 0, 0, 2, 1,
              19699, 0, 2, 0, 3, 1,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [0, 20, 4, 55, 0, 0,
              0, 11, 57, 0, 0, 0,
              0, 0, 0, 0, 1, 0,
              7, 0, 3, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 2,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 1,
              0, 451, 1, 0, 2, 0,
              1, 0, 2, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [88, 1105, 175, 2012, 688, 0,
              15, 142, 290, 100, 37, 7,
              97, 2, 9, 4, 16, 8,
              39, 6, 48, 6, 3, 4,
              1, 34, 0, 21, 2, 304,
              90, 6, 6, 2, 125, 7,
              1, 7, 2, 8, 1, 4,
              0, 1, 0, 2, 7, 48,
              2, 0, 26303, 1, 7, 2,
              2, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [28, 345, 7, 287, 36, 13,
              1, 19, 7, 1, 12, 2,
              3, 188, 0, 0, 1, 0,
              4, 76, 19, 6, 0, 1,
              0, 0, 0, 1, 1, 2,
              33, 3, 0, 0, 0, 1,
              0, 0, 0, 2, 0, 0,
              0, 1, 0, 2, 2, 0,
              0, 0, 0, 5149, 0, 0,
              0, 0, 0, 0, 2, 41,
              0, 0, 0, 0, 0, 0],
             [2, 1207, 28, 4035, 19, 0,
              5, 121, 3094, 8, 11, 1,
              68, 37, 2, 8, 26, 16,
              54, 0, 77, 4, 5, 0,
              0, 0, 0, 2, 2, 2,
              0, 5, 103, 0, 0, 12,
              0, 4, 3, 2, 2, 0,
              0, 3, 0, 0, 8, 7,
              3, 5, 7, 0, 28810, 13,
              15, 0, 6, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [5, 1939, 85, 6224, 191, 0,
              16, 943, 686, 9, 177, 76,
              135, 0, 0, 21, 111, 52,
              1392, 1, 364, 19, 6, 12,
              0, 1, 0, 14, 33, 9,
              20, 18, 1, 0, 5, 40,
              36, 20, 25, 65, 15, 0,
              0, 5, 0, 18, 27, 38,
              2, 0, 1, 0, 74, 34636,
              9, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [0, 173, 1, 498, 6, 0,
              0, 36, 717, 0, 0, 0,
              9, 0, 0, 2, 7, 1,
              15, 0, 15, 0, 0, 2,
              0, 0, 0, 1, 0, 1,
              1, 0, 3, 0, 0, 0,
              0, 1, 0, 0, 1, 0,
              0, 1, 0, 0, 0, 0,
              0, 1, 0, 0, 6, 0,
              5271, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [0, 154, 5, 259, 0, 7,
              0, 9, 1, 0, 3, 3,
              11, 0, 54, 1, 1, 3,
              2, 1, 8, 1, 0, 4,
              374, 0, 0, 2, 1, 4,
              0, 0, 0, 0, 0, 0,
              0, 2, 0, 0, 6, 0,
              77, 0, 0, 0, 1, 0,
              0, 0, 0, 0, 0, 0,
              0, 3346, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [0, 117, 1, 399, 0, 0,
              2, 15, 112, 0, 0, 1,
              0, 0, 0, 0, 0, 1,
              8, 0, 5, 1, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 3, 0, 0, 0, 0,
              0, 1, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 8, 0,
              0, 0, 2640, 0, 0, 0,
              0, 0, 0, 0, 0, 0],
             [0, 58, 0, 212, 9, 0,
              1, 46, 62, 17, 33, 5,
              0, 0, 0, 4, 3, 1,
              193, 0, 10, 2, 0, 0,
              0, 0, 0, 0, 0, 1,
              0, 1, 0, 0, 0, 0,
              1, 3, 0, 13, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 2, 0, 0, 0,
              0, 0, 0, 1289, 0, 0,
              0, 0, 0, 0, 0, 0],
             [0, 18, 0, 3, 0, 0,
              0, 1, 0, 0, 0, 0,
              0, 43, 0, 0, 0, 0,
              0, 2, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 1,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 414, 0,
              0, 0, 0, 0, 0, 0],
             [1, 57, 2, 44, 3, 1,
              0, 3, 0, 0, 1, 0,
              0, 37, 0, 0, 2, 0,
              2, 17, 5, 1, 0, 0,
              0, 0, 0, 0, 0, 0,
              17, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 15, 0, 0,
              0, 0, 0, 0, 0, 1021,
              0, 0, 0, 0, 0, 0],
             [0, 80, 3, 136, 0, 0,
              1, 9, 5, 121, 0, 0,
              0, 0, 0, 1, 0, 0,
              1, 0, 4, 0, 0, 0,
              0, 8, 0, 0, 0, 0,
              0, 0, 0, 0, 143, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              768, 0, 0, 0, 0, 0],
             [0, 121, 0, 335, 0, 0,
              3, 14, 4, 0, 19, 2,
              2, 0, 0, 0, 4, 11,
              7, 0, 3, 2, 0, 0,
              0, 0, 0, 2, 0, 0,
              2, 0, 0, 0, 0, 0,
              0, 0, 3, 2, 0, 0,
              0, 0, 0, 1, 2, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 1702, 0, 0, 0, 0],
             [0, 0, 0, 4, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 45, 0, 0, 0],
             [0, 25, 2, 46, 0, 1,
              1, 8, 0, 2, 1, 1,
              5, 0, 0, 0, 0, 0,
              2, 0, 3, 1, 0, 0,
              21, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 1, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 526, 0, 0],
             [0, 1, 0, 2, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 63, 0],
             [0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 2]])

    def create_feature(self):
        engager_main_language_feature = EngagerMainLanguage(self.dataset_id)
        tweet_language_feature = MappedFeatureTweetLanguage(self.dataset_id)

        engager_main_language_df = engager_main_language_feature.load_or_create()
        tweet_language_df = tweet_language_feature.load_or_create()

        statistical_data = self.statistical_data.astype(np.float)

        # normalize all the data
        for row in range(statistical_data.shape[0]):
            if statistical_data[row].sum() > 0:
                statistical_data[row] = statistical_data[row] / statistical_data[row].sum()

        result = pd.DataFrame(
            [statistical_data[x][y]
             for x, y
             in zip(engager_main_language_df[engager_main_language_feature.feature_name],
                    tweet_language_df[tweet_language_feature.feature_name])]
        )

        self.save_feature(result)